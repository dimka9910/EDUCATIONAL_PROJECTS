Оглавление

[Введение 4](#_Toc71060025)

[1.1 Системные требования 5](#_Toc71060026)

[1.2 Установка и запуск программы 5](#_Toc71060027)

[1.3 Запуск программы 5](#_Toc71060028)

[1.4 Работа с программой 6](#_Toc71060029)

[1.4.1 Обзор интерфейса начального окна 6](#_Toc71060030)

[1.4.2 Импорт файлов данных 7](#_Toc71060031)

[1.4.3 Информация о данных 7](#_Toc71060032)

[1.4.4 Удаление ненужных импортированных данных 9](#_Toc71060033)

[1.4.5 Создание рабочего окна с данными 10](#_Toc71060034)

[1.4.6 Обзор интерфейса рабочего окна 10](#_Toc71060035)

[1.4.7 Добавление данных в рабочее окно 11](#_Toc71060036)

[1.4.8 Работа с данными: окно легенды Plots 11](#_Toc71060037)

[1.4.9 Работа с данными: окно графиков и методы отображения 12](#_Toc71060038)

[1.4.10 Фильтрация сигнала: метод Digital Filters 14](#_Toc71060039)

[1.4.11 Быстрое преобразование фурье: метод FFT 18](#_Toc71060040)

[1.4.12 Удаление ненужных данных из рабочего окна 18](#_Toc71060041)

[1.5 Выход из программы 18](#_Toc71060042)

[2. Программная часть. 19](#_Toc71060043)

[2.1 Системные требования 19](#_Toc71060044)

[2.2 Подготовка к запуску проекта 19](#_Toc71060045)

[2.3 Запуск проекта 19](#_Toc71060046)

[2.4 Описание файлов проекта 20](#_Toc71060047)

[2.4.1 Конфигурационный файл 20](#_Toc71060048)

[2.4.2 Заголовочные файлы 21](#_Toc71060049)

[2.4.2 Исходные файлы 21](#_Toc71060050)

[2.4.3 Файлы форм 21](#_Toc71060051)

[2.5 Добавление нового фильтра 21](#_Toc71060052)

[2.5.1 Требования к добавляемому фильтру 21](#_Toc71060053)

[2.5.2 Каталог дополнения 23](#_Toc71060054)

[2.5.3 Модификация файла probe.pro 23](#_Toc71060055)

[2.5.4 Модификация файла digitalfiltersdialog.cpp 23](#_Toc71060056)

[2.5.5 Модификация формы digitalfilterdialog.ui 26](#_Toc71060057)

[2.6 Сборка проекта 27](#_Toc71060058)

[Заключение 27](#_Toc71060059)

[Список используемых источников: 29](#_Toc71060060)

Введение

Цифровая обработка сигналов (ЦОС) в настоящее время является одной из самых развивающихся отраслей. Она охватывает множество предметных областей, таких как обработка изображений и биомедицинских данных, обработка сигналов с сонаров, радаров и сенсоров, спектральный анализ, обработка звука и речи. ЦОС широко распространена и используется повсеместно в нашем обиходе. Достижения этой области встречаются в различных устройствах: от устройств бытового назначения до военной промышленности.

Методами ЦОС являются математические соотношения или алгоритмы, в соответствии с которыми выполняются вычислительные операции над цифровыми сигналами. К ним относятся алгоритмы цифровой фильтрации, спектрально-корреляционного анализа, модуляции и демодуляции сигналов, адаптивной обработки и другие.

Инженеры постоянно сталкиваются с задачей обработки больших массивов данных, которые представляют из себя набор файлов, содержащих в себе значения сигналов, записанных с некоторых устройств\датчиков – аналого-цифровых преобразователей. Полученные данные могут содержать десятки различных сигналов, а сами данные могут быть записаны в сотни и тысячи файлов. Обработка такого большого количества информации без использования средств автоматизации, является долгим, а иногда и непосильным процессом. Инженер тратит большое количество времени (которое может быть ограничено) и усилий на выполнение обработки сигнала вручную вместо того, чтобы заниматься анализом результатов. Вследствие этого возникает следующая задача: автоматизация обработки сигнала – создание программного средства, позволяющего производить цифровую обработку сигнала на основе имеющихся данных. Решив данную задачу, будет облегчена работа инженера и повышена производительность его труда.

Программное средство осуществляющее цифровую обработку сигналов (компьютерный осциллограф) должно удовлетворять следующим требованиям:

- наличие различных методов цифровой обработки сигнала, а также возможность их добавления;
- наличие интуитивно понятного графического интерфейса;
- представление данных в удобном для пользователя формате;
- нетребовательность к ресурсам компьютера;
- кроссплатформенность.

Данные требования объясняются постановленной задачей: обработка данных и их визуализация в удобном виде пользователю для последующего анализа.

1. Пользовательская часть

## 1.1 Системные требования

Для запуска и использования компьютерного осциллографа необходимо, чтобы компьютер пользователя удовлетворял следующим минимальным системным требованиям:

- операционная система - MicrosoftWindowsXP, 10;
- объём свободной оперативной памяти - не менее 100 МБ;
- свободное место на диске - не менее 800 МБ;
- наличие архиватора WinRAR.

## 1.2 Установка и запуск программы

Программа «компьютерный осциллограф Probe» распространяется в архиве PROBE.RAR.

Для начала распакуйте архив.

![](RackMultipart20210504-4-h5obel_html_21fb3372c7be6cb5.png)

Рис. **1**. Разархивация компьютерного осциллографа.

После разархивации пользователь получит папку PROBE, в ней содержится программа компьютерного осциллографа.

## 1.3 Запуск программы

![](RackMultipart20210504-4-h5obel_html_25eebd18de4dabe6.png) Чтобы запустить программу, перейдите в паку Probe, далее в папку Probe\_AM. В ней запустите исполняемый файл Probe.exe.

## 1.4 Работа с программой

![](RackMultipart20210504-4-h5obel_html_c8ff2f483a2198f7.png) После запуска программы Probe.exe открывается начальное рабочее окно программы Probe, оно выглядит следующим образом (Рис. 2):

Рис. **2**. Основное окно программы Probe.

Для дальнейшей работы с программой нужно иметь файлы с данными в формате .csv.

### 1.4.1 Обзор интерфейса начального окна

Верхнее меню содержит следующие вкладки (Рис. 2):

1. file – содержит в себе 2 подпункта: NewFile – создает рабочую форму для работы с данными, GenerateRecordFile – создает новую запись;
2. settings – настройки;
3. window – настройки окна;
4. help – помощь.

Окно Records: Здесь отображаются импортированные данные.

Окно ниже окна Records: содержит 2 вкладки:

1. import: вкладка для выбора файла для импорта;
2. properties: вкладка отображающая данные о импортированном файле.

Окно справа: Рабочее окно, в котором графически отображаются данные, а также инструменты для работы с ними.

### 1.4.2 Импорт файлов данных

Чтобы импортировать файл данных типа .csv в программу компьютерного осциллографа пользователю необходимо в рабочем окне программы открыть вкладку Import левым щелчком мыши (Вкладка находится в левом нижнем углу) (Рис. 3).

![](RackMultipart20210504-4-h5obel_html_f57138da8c1a4e34.png)

Рис. **3**. Импорт .csv файлов данных.

Открыв вкладку Import, в окне над вкладкой Import отобразится каталог файловой системы. Серым шрифтом указаны файлы, которые нельзя импортировать, черным – которые можно.

Пользователю необходимо выбрать путь к файлу типа .csv и сделать на имени файла двойной щелчок левой кнопкой мыши. После этого файл попадет в список и будет отображен в окне Records.

### 1.4.3 Информация о данных

Пользователь может получить информацию о используемы данных (Рис. 4). Для этого в окне Records пользователю необходимо выбрать левым щелчком мыши данные о которых он хочет получить информацию. Затем, пользователю необходимо выбрать левым щелчком мыши вкладку «Properties» (в левом нижнем углу). После чего пользователь получит следующую информацию о данных:

- record type – тип записи;
- obtaining – способ получения данных;
- name – имя данных;
- description – описание данных;
- sourcename – имя данных в источнике;
- sourcefile – имя файла источника;
- source file path – путь кфайлу источнику;
- source file type – типфайлаисточника;
- computername (created) – имя компьютера, создавшего запись;
- userName (created) – имя пользователя, создавшего запись;
- date (created) – дата создания;
- time (created) – время создания;
- computerName (modified) – имя компьютера, модифицирующего запись;
- username (modified) – имя пользователя, модифицирующего запись;
- date (modified) – дата модификации;
- time (modified) – время модификации;
- length – длинна данных;
- x units– х единиц;
- x units – у единиц;
- fixed step – фиксированный шаг;
- step length – длинна шага;
- max – максимум;
- min – минимум;
- графическое представление данных.

![](RackMultipart20210504-4-h5obel_html_1838450fdb7c5c42.png)

Рис. **4**. Информация о данных.

Также пользователь может модифицировать информацию о данных. Делается это следующим образом: пользователю необходимо двойным щелчком левой кнопки мыши нажать по информации, которую он хочет модифицировать, после чего данные подсветятся синим. Теперь пользователь может ввести свою информацию.

### 1.4.4 Удаление ненужных импортированных данных

В случае ненадобности импортировано файла в окне Records, пользователь может его удалить (Рис. 5). Для этого пользователю нужно щелкнуть правой кнопкой мыши по записи, которую он хочет удалить, появится контекстное меню, в котором пользователь должен выбрать пункт «DeleteProbeFile» и щелкнуть по нему левой кнопкой мыши.

![](RackMultipart20210504-4-h5obel_html_c5322ff1144615de.png)

Рис. **5**. Удаление импортированных файлов.

### 1.4.5 Создание рабочего окна с данными

Для создания рабочего окна с данными (Рис. 6) пользователю необходимо совершить левый щелчок мыши по кнопке меню «File» после чего откроется контекстное меню. В данном меню пользователь должен левым щелчком мыши выбрать пункт «NewFile».

Второй способ – пользователь должен нажать комбинацию клавиш «Ctrl+N».

![](RackMultipart20210504-4-h5obel_html_1196967fe724565f.png)

Рис. **6**. Рабочее окно с данными.

### 1.4.6 Обзор интерфейса рабочего окна

Рабочее окно делится на 2 окна (Рис. 6):

Верхнее окно: в данном окне отображаются графики данных. Также в нем содержатся методы для работы с графиками и данными:

1. selection – выбор;
2. drag – перемещение по графику;
3. tracer – индикатор (курсор х:у);
4. band zoom – масштабирование полосы;
5. frame zoom – масштабирование кадра;
6. analysisband – установить диапазона для анализа;
7. digital filters – цифровая фильтрация;
8. fft– быстрое преобразование Фурье.

Нижнее окно Plots: в данном окне отображается информация о графиках, построенных в верхнем окне.

1. name – имя данных;
2. sourcefile – имя исходного фала данных;
3. color – цвет графика;
4. linestyle – тип стиля линии;
5. line width – ширина линии;
6. scatter – разброс.

### 1.4.7 Добавление данных в рабочее окно

Чтобы добавить данные в рабочее окно (Рис. 7), пользователю необходимо в окне «Records» выбрать данные (предварительно раскрыть их левым щелчком мыши по (+)), которые он собирается добавить и совершить двойной щелчок левой кнопкой мыши по ним. После этого данные отобразятся на графике и под окном с графиком появится легенда.

![](RackMultipart20210504-4-h5obel_html_8bbd7e16f53ff2fd.png)

Рис. **7**. Добавление данных в рабочее окно.

### 1.4.8 Работа с данными: окно легенды Plots

В данном окне отображается легенда графиков, построенных в окне выше.

Легендасодержитвсебеследующиеполя: Name, Source File, Color, Line Style, Line Width, Scatter.

Пользователь может модифицировать легенду (рис. 8) для более наглядного отображения данных. Пользователь может сделать это следующим образом: нажав тройным щелчком левой кнопкой мыши по изменяемому параметру, после чего появится контекстное меню, в котором пользователь левым щелчком мыши выбирает как должен выглядеть параметр.

Для изменения доступны следующие параметры:

- color – изменить цвет графика;
- linestyle – изменить стиль линии графика;
- linewidth – изменить толщину линии графика;
- scatter – изменить разброс графика.

![](RackMultipart20210504-4-h5obel_html_da348bd483a5e746.png)

Рис. **8**. Изменение параметров легенды.

### 1.4.9 Работа с данными: окно графиков и методы отображения

В данном окне отображаются графики данных. Также в нем содержатся методы для работы с графиками и данными. Пользователю доступны следующие методы:

Метод **Selection** : нажав левой кнопкой мыши по данной кнопке, курсор пользователя вернется в исходное состояние.

Метод **Drag** : нажав левой кнопкой мыши по данной кнопке, курсор пользователя превратится в «руку». Нажав и держа левую кнопку мыши в окне графиков, пользователь может перемещаться по окну графиков.

Метод **Tracer** : нажав левой кнопкой мыши по данной кнопке, курсор пользователя в окне графиков превратится в «прицел» (Рис. 9). Перемещая курсор по графику, пользователь будет видеть точную координату по оси Х и У.

![](RackMultipart20210504-4-h5obel_html_b95437b2b5cdc9f4.png)

Рис. **9**. Метод Tracer.

Метод **Band**** Zoom**: нажав левой кнопкой мыши по данной кнопке, пользователь включает режим масштабирования полосы графика. На графике зажав левую кнопку мыши и ведя курсор от начальной точки до конечной, пользователь выбирает место (Рис. 10), которое он хочет масштабировать (выделяется синим). После чего на графике отображается только выбранная пользователем полоса. Для того, чтобы отменить масштабирование, пользователь должен нажать правой кнопкой мыши в окне графиков.

![](RackMultipart20210504-4-h5obel_html_4eaa74bb888f04bb.png)

Рис. **10**. Метод Band Zoom.

Метод **Frame**** Zoom**: нажав левой кнопкой мыши по данной кнопке, пользователь включает режим масштабирования кадра графика. Аналогично методу «BandZoom», пользователь, на графике зажав левую кнопку мыши и ведя курсор от начальной точки до конечной, выбирает квадрат (кадр), который он хочет масштабировать (выделяется синим). После чего на графике отображается только выбранный пользователем кадр. Для того, чтобы отменить масштабирование, пользователь должен нажать правой кнопкой мыши в окне графиков.

Метод **Analysis**** Band**: нажав левой кнопкой мыши по данной кнопке,пользователь включает режим выбора полосы графика для дальнейшего анализа. На графике зажав левую кнопку мыши и ведя курсор от начальной точки до конечной (аналогично методу «BandZoom»), пользователь выбирает место (Рис. 11), которое он хочет изучать (выделяется желтым). После чего на графике отображается желтым выбранная пользователем полоса для изучения. Для того, чтобы отменить выделение, пользователь достаточно нажать Selection или щелкнуть левой кнопкой мыши вне выделенной области на графике.

![](RackMultipart20210504-4-h5obel_html_64f5b53c286a5468.png)

Рис. **11**. Метод Analysis Band.

Оставшиеся два метода DigitalFilters и FFT рассмотрим подробнее в следующих главах.

### 1.4.10 Фильтрация сигнала: метод Digital Filters

Нажав левой кнопкой мыши по кнопке DigitalFilters откроется новое окно «DigitalFilters». В данном окне представлены инструменты для цифровой обработки сигнала (фильтрации) (Рис. 12).

![](RackMultipart20210504-4-h5obel_html_c34b50cc27be29cd.png)

Рис. **12**. Digital Filters.

В зависимости от того, выбрал ли пользователь изучаемую область или нет справа отображается график данных (полностью или частично). Синим отображаются исходные данные, а красным – данные поле фильтрации (Рис. 13).

В графе «SampleRate» [Hz] указана частота сигнала.

Если исследуется несколько сигналов, пользователь может выбрать конкретный, который он собирается изучать. Для этого ему необходимо нажать левой кнопкой мыши по графе «InputData», появится контекстное меню с доступными для изучения сигналами. Левой кнопкой мыши, пользователь должен выбрать сигнал, которой он собирается исследовать, после чего изображение графика обновится.

В графе «FilterType» пользователю предлагается выбрать один из доступных фильтров для фильтрации сигнала. Пользователю необходимо нажать левой кнопкой мыши по данной графе и выбрать тип фильтра, который он хочет применить к заданному сигналу (также левой кнопкой мыши).

В окне «FilterOptions» задаются конфигурации (настройки) фильтра. В зависимости от выбранного фильтра, пользователь может установить следующие параметры:

- filter order – порядок фильтра;
- cutoff frequency [Hz] – частотасреза;
- ripple [dB]– пульсация;
- stop band [dB] – стоп-диапазон;
- roll-off [dB/8ve] – спадание;
- center Frequency [Hz] – центральнаячастота.

Пользователь может вводить параметры фильтра как вручную (нажав левой кнопкой мыши по окну параметра и введя значение с клавиатуры), так и при помощи кнопок больше меньше (нажав левой кнопкой по стрелке вверх или вниз справа от окна параметра).

В окне «FilterMode» задается тип используемого фильтра. Пользователь может выбрать тип фильтра нажав левой кнопкой по соответствующему необходимому ему типу фильтра. Пользователю доступны следующие типы фильтров:

- lowpass – низкочастотный;
- highpass – высокочастотный;
- bandpass– с полосой пропускания;
- bandstop – с ограничителем полосы.

Графа «Использовать новые фильтры» отвечает за то, какие фильтры будут доступны пользователю: стандартные (описанные выше) или новые (недавно добавленные). Нажав по данной графе левой кнопкой мыши, предыдущие (стандартные) фильтры станут неактивными («FilterType», «FilterOptions», «FilterMode» будут недоступны для изменения и будут окрашены серым цветом). Повторное нажатие по данной графе делает неактивными новые фильтры и возвращает в активное состояние стандартные фильтры.

Новые типы фильтры выбираются в списке под графой «Использовать новые фильтры» аналогично тому, как выбирались стандартные типы фильтров.

Аналогично пользователем задаются с клавиатуры параметры фильтров ниже в графе «FrequencyHz» и «CutoffFrequencyHz»

![](RackMultipart20210504-4-h5obel_html_edd0f0f80d935223.png)

Рис. **13**. Фильтрация сигнала.

Список доступных фильтров:

Стандартные:

1. bessel;
2. chebyshevI;
3. chebyshevII;
4. eliptical.

Новые:

1. alphatrimmedmean;
2. mean;
3. median;
4. butterworth low pass 2 order.

Для того чтобы применить фильтр пользователю необходимо нажать левой кнопкой мыши по кнопке «Применить фильтр».

При постановке галочки (путем нажатия левой кнопки мыши по чекбоксу) в графу «Saveresultinoriginalrecord», после нажатия кнопки «ОК» оригинальные данные будут переписаны данными после фильтрации (отмена данной операции – кнопка «Cancel»).

Для выхода из области рабочего окна «DigitalFilters» пользователю необходимо закрыть окно «DigitalFilters».

### 1.4.11 Быстрое преобразование фурье: метод FFT

Нажав левой кнопкой мыши по кнопке FFT откроется новое окно «FFT». В данном окне представлено быстрое преобразование Фурье (Рис. 14)

![](RackMultipart20210504-4-h5obel_html_2d2489499ed075e5.png)

Рис. **14**. FFT.

В верхнем окне «Amplitude» представлен график амплитуд, в нижнем «Phase» график фаз.

Выбор исследуемых данных производится пользователем при помощи выбора тех самых данных из списка (пуем нажатия левой кнопки мыши по необходимым данным из выпадающего списка) находящегося в левом нижнем углу.

Для выхода из области рабочего окна «FFT» пользователю необходимо закрыть окно «FFT».

### 1.4.12 Удаление ненужных данных из рабочего окна

Для удаление ненужных данных из рабочго окна, пользователю выбрать ненужные данные в легенде, нажав по ним левой кнопкой мыши. После чего нужно нажать кнопку «Delete» на клавиатуре.

## 1.5 Выход из программы

Для выхода из программы «Probe» пользователю необходимо закрыть окно программы «Probe».

# 2. Программная часть.

## 2.1 Системные требования

- QTCreator версии 4.14.2 и старше
- С++ 11

![](RackMultipart20210504-4-h5obel_html_9af4091326057f82.png)

## 2.2 Подготовка к запуску проекта

Готовый проект для запуска в среде QTCreator находится так же в исходном архиве в папке Oscillograph.

Так же вы можете найти его на GITHUB:

https://github.com/dimka9910/EDUCATIONAL\_PROJECTS/tree/main/C%2B%2B%20C%23/Oscilograph/test15

## 2.3 Запуск проекта

После разархивации необходимо перейти в папку Oscillograph и запустить проект Probe.pro.

Инженер должен выбрать компилятор DesktopQt 5.5.1 MinGW 32bit, после чего откроется окно разработчика - IDEQtCreator (Рис. 17):

![](RackMultipart20210504-4-h5obel_html_fdd78dd83f948911.png)

Рис. **17**. IDE Qt Creator.

## 2.4 Описание файлов проекта

Проект состоит из следующих фалов и папок:

- probe.pro – конфигурационный файл;
- заголовочные – папка с заголовочными файлами (.h);
- исходники – папка с исходными файлами (.cpp);
- формы – папка с формами (.ui).

Далее кратко опишем каждую составляющую проекта:

### 2.4.1 Конфигурационный файл

Конфигурационный файл Probe.pro используется для сборки проекта. В нем указаны все заголовочные, исходные файлы и файлы форм.

![](RackMultipart20210504-4-h5obel_html_c8223eb9519856cb.png)

### 2.4.2 Заголовочные файлы

В заголовочных файлах соответственно содержатся все заголовочные файлы. Папка «заголовочные» состоит из:

- dspFilters – папка, содержащая в себе заголовочные файлы стандартных фильтров (разработана университетом MIT);
- kissfft-master – папка, содержащая в себе заголовочные файлы быстрого преобразования Фурье;
- newFilters – папка, содержащая в себе заголовочные файлы новых фильтров;
- \*.h – заголовочные файлы, описывающие архитектуру программы Probe (логику поведения, хранение данных и т.д.).

### 2.4.2 Исходные файлы

В исходных файлах соответственно содержатся все исходные файлы. Папка «заголовочные» состоит из:

- dspFilters – папка, содержащая в себе исходные файлы стандартных фильтров (разработана университетом MIT);
- kissfft-master – папка, содержащая в себе исходные файлы быстрого преобразования Фурье;
- newFilters – папка, содержащая в себе исходные файлы новых фильтров;
- \*.h – исходные файлы, описывающие архитектуру программы Probe (логику поведения, хранение данных и т.д.).

### 2.4.3 Файлы форм

Файлы форм содержат все файлы форм, которые описывают графический интерфейс программы.

## 2.5 Добавление нового фильтра

Для того, чтобы модифицировать компьютерный осциллограф Probe, а именно: добавить новый фильтр, инженеру необходимо выполнить следующие действия:

### 2.5.1 Требования к добавляемому фильтру

Добавляемый фильтр должен быть реализован как процедура или класс. В заголовочном файле (.h) должно содержаться определение фильтра, а в (.cpp) исполняемый код.

Фильтр должен принимать в себя следующие параметры:

- double\* Signal – принимает исходный сигнал типа double.
- double\* FiltredSignal – принимает массив double, в который записывает отфильтрованный сигнал.
- intSignalSize – принимает размер\длину сигнала

Примеркода:

…

void filter\_type(double\* signal, double\* filtredsignal, int signalsize);

…

Примерфильтра

#include\&lt;memory.h\&gt;

#include&quot;kalmanfilter.h&quot;

_// __1D__ Kalman __FILTER__ implementation __signal__ - __input__ signal __result__ - __output__ signal_

_// __N__ - __length__ of __the__ signal_

void\_kalmanfilter(_const_element\*signal,element\*,result,intN,doubleQ,doubleR)

{

_//Q __-__ dispersion, __R__ - __error__ of__measurements_

doublex\_p,p\_p,k\_k;_// __x\_p,__ p\_p __-__ predicted __values,__ k\_k __-__ kalman__coef._

_// __prediction__ for __the__ first__element_

x\_p=signal[0];

p\_p=Q;

result[0]=x\_p;

_// __For__ all __elements__ of __the__ signal_

_for_(inti=1;i\&lt;N;++i)

{

_//__correction:_

k\_k=p\_p/(p\_p+R);

x\_p=x\_p+k\_k\*(signal[i]-x\_p);

p\_p=(1.0-k\_k)\*p\_p+Q;

result[i]=x\_p;

}

}

_// __1D__ Kalman __FILTER__ wrapper_

_// __signal__ - __input__ signal_

_// __result__ - __output__ signal_

_// __N__ - __length__ of __the__ signal_

voidkalmanfilter(element\*signal,element\*result,intN,doubleQ,doubleR)

{

_// __Check__ arguments_

_if_(!signal||N\&lt;1)

_return_;

_if_(Q\&lt;0&amp;R\&lt;0)

{

Q=100;

R=0;

}

_// __Treat__ special __case__ N __=__ 1_

_if_(N==1)

{

_if_(result)

result[0]=signal[0];

_return_;

}

_// __Call__ kalman __filter__ implementation_

\_kalmanfilter(signal,result,N,Q,R);

}

### 2.5.2 Каталог дополнения

Файлы фильтра необходимо добавить в соответствующую папку PROBE\_PROJECT/NewFilters.

### 2.5.3 Модификация файла probe.pro

В конфигурационном файле probe.pro инженер должен прописать в заголовочных и исходных файлах файлы фильтра, которые он добавляет:

…

SOURCES += main.cpp\

mainwindow.cpp \

…

NewFilters/my\_filter.cpp \

…

HEADERS += mainwindow.h \

global.h \

...

NewFilters\my\_filter.h \

…

### 2.5.4 Модификация файла digitalfiltersdialog.cpp

В данном файле происходит фильтрация исходных данных: происходит диалог между пользователем и программой. Пользователь устанавливает фильтр, исходные данные отправляются в заданный пользователем фильтр, после чего фильтрованные данные отрисовываются на графике.

Необходимо включить в данный файл заголовочный файл подключаемого фильтра:

#include &quot;digitalfiltersdialog.h&quot;

…

#include &quot;NewFilters/my\_filter.h&quot;

…

После необходимо модифицировать процедуру фильтрации сигнала «filterOriginalData»:

void DigitalFiltersDialog::filterOriginalData(const FilterElement &amp;filterElement)

{

if (pOrigGraph==0) return;

…

//Здесь указан код добавленный студентом для реализации новых фильтров

int SignalSize=values.size();

double Signal[SignalSize], FiltredSignal[SignalSize];

for (int i=0; i \&lt; SignalSize; i++)

{

Signal[i]=values[i];

FiltredSignal[i]=0;

}

if (ui-\&gt;radioButtonNewFilters-\&gt;isChecked())

{

switch (ui-\&gt;comboBoxNewFilters-\&gt;currentIndex())

{

… //Для добавляемого фильтра необходимо добавить case

casen: //где n – номер добавляемого фильтра

{

my\_filter(Signal,FiltredSignal,SignalSize);

for (int i = 0; i \&lt; values.size(); ++i)

{

values[i]=static\_cast\&lt;double\&gt;(FiltredSignal[i]);

}

break;

}

…

}

default:

{

for (int i = 0; i \&lt; values.size(); ++i)

{

FiltredSignal[i]=0.5;

values[i]=static\_cast\&lt;double\&gt;(FiltredSignal[i]);

}

break;

}

}

}

else

…

{

// Filter code. Здесьуказанкодстандартнойфильтрации

…

}

… //Отрисовка фильтрованного сигнала

}

Данная процедура модифицирована для удобства добавления новых фильтров (добавлено ветвление если):

В случае если пользователем используются стандартные фильтры, то используется стандартная фильтрация (проверка: нажат ли чекбокс).

В случае если пользователем используются новые фильтры, то программа заходит в конструкцию switch, которая в зависимости от выбранного фильтра выполняет соответствующий case. Данный switch описывается единожды, далее для добавления нового фильтра инженер должен добавить case для нового фильтра.

Также в данном файле единожды модифицируются следующая процедура: DigitalFiltersDialog – конструктор графической формы. Добавляем в него, что при загрузке новые фильтры считаются выключенными.

DigitalFiltersDialog::DigitalFiltersDialog(QWidget \*parent) :

…

ui-\&gt;lineEdit\_2-\&gt;setEnabled(false);

ui-\&gt;lineEdit\_4-\&gt;setEnabled(false);

ui-\&gt;lineEdit\_Freq-\&gt;setEnabled(false);

ui-\&gt;lineEdit\_FreqCutoff-\&gt;setEnabled(false);

ui-\&gt;comboBoxNewFilters-\&gt;setEnabled(false);

ui-\&gt;lineEdit\_Freq-\&gt;setEnabled(false);

…

Также единожды добавляем поведение чекбокса «Использовать новые фильтры» и поведение нажатия кнопки «Применить фильтр»:

void DigitalFiltersDialog::on\_radioButtonNewFilters\_clicked()

{

if (ui-\&gt;radioButtonNewFilters-\&gt;isChecked())

{

ui-\&gt;lineEdit\_Freq-\&gt;setEnabled(true);

ui-\&gt;lineEdit\_FreqCutoff-\&gt;setEnabled(true);

ui-\&gt;comboBoxNewFilters-\&gt;setEnabled(true);

ui-\&gt;comboBoxFilterType-\&gt;setEnabled(false);

ui-\&gt;spinBoxFilterOrder-\&gt;setEnabled(false);

ui-\&gt;doubleSpinBoxCenterFr-\&gt;setEnabled(false);

ui-\&gt;doubleSpinBoxCutoffFr-\&gt;setEnabled(false);

ui-\&gt;doubleSpinBoxFrWidth-\&gt;setEnabled(false);

ui-\&gt;doubleSpinBoxRipple-\&gt;setEnabled(false);

ui-\&gt;doubleSpinBoxRollOff-\&gt;setEnabled(false);

ui-\&gt;doubleSpinBoxStopBand-\&gt;setEnabled(false);

ui-\&gt;radioButtonBandPass-\&gt;setEnabled(false);

ui-\&gt;radioButtonBandStop-\&gt;setEnabled(false);

ui-\&gt;radioButtonHightPass-\&gt;setEnabled(false);

ui-\&gt;radioButtonLowPass-\&gt;setEnabled(false);

}

else

{

ui-\&gt;comboBoxNewFilters-\&gt;setEnabled(false);

ui-\&gt;lineEdit\_2-\&gt;setEnabled(false);

ui-\&gt;lineEdit\_4-\&gt;setEnabled(false);

ui-\&gt;lineEdit\_Freq-\&gt;setEnabled(false);

ui-\&gt;lineEdit\_FreqCutoff-\&gt;setEnabled(false);

ui-\&gt;comboBoxFilterType-\&gt;setEnabled(true);

ui-\&gt;spinBoxFilterOrder-\&gt;setEnabled(true);

ui-\&gt;doubleSpinBoxCenterFr-\&gt;setEnabled(true);

ui-\&gt;doubleSpinBoxCutoffFr-\&gt;setEnabled(true);

ui-\&gt;doubleSpinBoxFrWidth-\&gt;setEnabled(true);

ui-\&gt;doubleSpinBoxRipple-\&gt;setEnabled(true);

ui-\&gt;doubleSpinBoxRollOff-\&gt;setEnabled(true);

ui-\&gt;doubleSpinBoxStopBand-\&gt;setEnabled(true);

ui-\&gt;radioButtonBandPass-\&gt;setEnabled(true);

ui-\&gt;radioButtonBandStop-\&gt;setEnabled(true);

ui-\&gt;radioButtonHightPass-\&gt;setEnabled(true);

ui-\&gt;radioButtonLowPass-\&gt;setEnabled(true);

}

}

void DigitalFiltersDialog::on\_pushButton\_clicked()

{

updateDataSlot(ui-\&gt;comboBoxInputData-\&gt;currentIndex());

}

Сутьихдействия:

Кнопка «Применить фильтр» посылает сигнал, активирующий фильтрацию и обновления графика.

Чекбокс «Использовать новые фильтры» при активации разрешает использовать новые фильтры и устанавливать им параметры одновременно запрещая использовать старые фильтры и менять их параметры и соответственно наоборот.

### 2.5.5 Модификация формы digitalfilterdialog.ui

Данная форма – интерфейс для общения между пользователем и программой. В данной форме пользователь выбирает необходимые данные, настраивает необходимый ему фильтр и получает от программы ответ в виде графиков исходного и фильтрованного сигнала.

В данную форму единожды добавляем следующие элементы:

- radioButtonNewFilters – элемент radioButton, используется как чекбокс «Использовать новые фильтры»;
- comboBoxNewFilters – элемент comboBox, используется для выбора фильтра из новых фильтров;
- lineEdit\_3 – элемент lineEdit, используется как текстовая подпись;
- lineEdit\_4 – элемент lineEdit, используется как текстовая подпись;
- lineEdit\_Freq – элемент lineEdit, используется для получения фильтром параметра Frequency;
- lineEdit\_FreqCutoff - элеент lineEdit, используется для получения фильтром параметра CutoffFrequency.

Добавление данных элементов выполняется простым переносом (drag-n-drop) из списка доступных элементов в нашу форму. В результате имеем (Рис.18):

![](RackMultipart20210504-4-h5obel_html_33debdac8abdf1cd.png)

Рис. **18**. Итоговая форма DigitalFiltersDialog.

## 2.6 Сборка проекта

Для сборки проекта инженеру необходимо открыть в меню QtCreator «Сборка», выбрать «Очистить проект «Probe»» (данное действие удаляет предыдущий собранный проект если таковой имеется), после чего в той же вкладке «собрать проект «Probe»».

После данных действий собранный проект находится в папке PROBE\_PROJECT\build-Probe-Desktop\_Qt\_5\_5\_1\_MinGW\_32bit-Debug.

# Заключение

В курсовой работе был рассмотрен компьютерный осциллограф для визуализации и цифровой обработки результатов физического эксперимента «Probe».

Предоставляемый программный код был модифицирован для соответствия современным версиям программного обеспечения.

Данный осциллограф был рассмотрен с двух сторон: со стороны пользователя и со стороны программного инженера.

Со стороны пользователя: в курсовой работе было рассмотрено взаимодействие между пользователем и программой. Описан весь цикл работы с программой: от системных требований и способа установки, до описания интерфейсов и способа работы с ними.

Со стороны программного инженера: в курсовой работе было рассмотрено, как работать с проектом компьютерного осциллографа Probe, какие средства необходимы для изучения и модификации проекта, описаны файлы проекта, а также описан способ добавления новых фильтров в проект.

В результате имеем полную пользовательскую и инженерную документацию для компьютерного осциллографа Probe.

# Список используемых источников:

| [1] | В. Тутыгин, Цифровая обработка сигналов: конспект лекций, Санкт-Петербург: Издательство Политехничкеского ун-та, 2013. |
| --- | --- |
| [2] | А.Кушнир. Многоканальный компьютерный осциллограф для визуализации и цифровой обработки результатов физического эксперимента. Выпускная работа бакалавра, СПбПУ, 2015г. |
| [3] | М.Ручин, Компьютерный осциллограф для визуализации и цифровой обработки результатов физического эксперимента. Курсовой проект, СПбПУ, 2016г. |
| [4] | Официальная документация MinGW. [http://mingw.org/](http://mingw.org/). |
| [5] | Официальная документация Qt. [http://doc.qt.io/](http://doc.qt.io/).

 |